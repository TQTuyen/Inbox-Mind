#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ðŸ” Running affected checks in parallel..."

# Get number of CPU cores for parallel execution
CORES=$(nproc 2>/dev/null || sysctl -n hw.ncpu 2>/dev/null || echo 4)

npx nx affected \
  --targets=lint,type-check,test \
  --uncommitted \
  --parallel=$((CORES > 1 ? CORES - 1 : 1))

npx nx format:write --uncommitted

echo "âœ… All checks passed!"
